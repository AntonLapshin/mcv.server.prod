function authorize(e,o){var r=e.installed.client_secret,t=e.installed.client_id,i=e.installed.redirect_uris[0],n=new googleAuth,s=new n.OAuth2(t,r,i);fs.readFile(TOKEN_PATH,function(e,r){e?getNewToken(s,o):(s.credentials=JSON.parse(r),o(s))})}function getNewToken(e,o){var r=e.generateAuthUrl({access_type:"offline",scope:SCOPES});console.log("Authorize this app by visiting this url: ",r);var t=readline.createInterface({input:process.stdin,output:process.stdout});t.question("Enter the code from that page here: ",function(r){t.close(),e.getToken(r,function(r,t){return r?void console.log("Error while trying to retrieve access token",r):(e.credentials=t,storeToken(t),void o(e))})})}function storeToken(e){try{fs.mkdirSync(TOKEN_DIR)}catch(o){if("EEXIST"!=o.code)throw o}fs.writeFile(TOKEN_PATH,JSON.stringify(e)),console.log("Token stored to "+TOKEN_PATH)}function listFiles(e){var o=google.drive("v3");o.files.list({auth:e,pageSize:10,fields:"nextPageToken, files(id, name)"},function(e,o){if(e)return void console.log("The API returned an error: "+e);var r=o.files;if(0==r.length)console.log("No files found.");else{console.log("Files:");for(var t=0;t<r.length;t++){var i=r[t];console.log("%s (%s)",i.name,i.id)}}})}var fs=require("fs"),readline=require("readline"),google=require("googleapis"),googleAuth=require("google-auth-library"),SCOPES=["https://www.googleapis.com/auth/drive.metadata.readonly"],TOKEN_DIR=(process.env.HOME||process.env.HOMEPATH||process.env.USERPROFILE)+"/.credentials/",TOKEN_PATH=TOKEN_DIR+"drive-nodejs-quickstart.json";fs.readFile("client_secret.json",function(e,o){return e?void console.log("Error loading client secret file: "+e):void authorize(JSON.parse(o),listFiles)});